{
  config,
  lib,
  pkgs,
  ...
}: let
  cfg = config.modules.pentest;
in {
  options.modules.pentest.enable = lib.mkEnableOption "Penetration testing tools configuration";

  config = lib.mkIf cfg.enable {
    home = {
      packages = with pkgs; [
        #kdigger # kubernetes discovery tool
        airgeddon # wireless network auditor
        #  apktool # apk reverse engineering tool
        armitage # Metasploit GUI
        #  badsecrets # Test for use of known bad secrets in web applications
        bettercap # Complete, modular, portable and easily extensible MITM framework
        binwalk # forensic tool for reverse engineering firmware images
        burpsuite # web application security testing framework
        #  cifs-utils # tools for working with CIFS/SMB file systems
        cook-framework # for making word-lists
        dalfox # perimeteer and XSS scanner
        darkstat # Network traffic analyzer
        #  dcfldd # forensic tool for disk imaging
        #  ddrescue # data recovery and protection
        dirb # directory scanner
        dirbuster # directory scanner
        #  dnsenum # DNS reconnaissance tool
        #  dnsrecon # DNS reconnaissance tool
        dnstracer # DNS tracer
        dsniff # Collection of tools for network auditing and penetration testing
        enum4linux # enumerate information from a Windows or Samba server
        ettercap # Complete, modular, portable and easily extensible MITM framework
        #  evil-winrm # WinRM shell for pentesting
        exegol # Fully Featured Community Driven Hacking Environment
        exiv2 #
        # expliot # is a Framework for security testing and exploiting IoT products and IoT infrastructure.
        fcrackzip # zip password cracker
        ffuf # tool for web fuzzing and content discovery
        # fierce #
        foremost # forensic tool for disk imaging
        # fping # ftp client
        gallia # Pentest Framework for Automotive Domain
        ghost # is an Android post-exploitation framework that exploits ADB to remotely access an Android device.
        ghunt # is an offensive Google framework, designed to evolve efficiently It's currently focused on OSINT, but any use related with Google is possible.
        # gpart #
        # hackrf # radio frequency toolkit
        hashcat # world's fastest password recovery utility
        hashcat-utils # Set of small utilities for advanced password cracking
        hping3 #
        htb-toolkit # HTB toolkit
        hydra-gtk # network authentication cracker
        iaito # GUI for radare2
        john # password cracker
        kanha # webapp pentest suite
        katana # Webcrawler
        # lynis	# security auditing tool for Unix based systems
        maltego # Open source intelligence and forensics application, enabling to easily gather information about DNS, domains, IP addresses, websites, persons, and so on
        masscan # mass port scanner
        # mdbtools # tools for working with Microsoft Access databases
        # libfreefare-bin # MIFARE card manipulations binaries
        # libnfc-bin # Near Field Communication (NFC) binaries
        # mfcuk # MiFare Classic Universal toolKit
        # mfoc # MIFARE Classic offline cracker
        medusa # network authentication cracker
        metasploit # Metasploit framework
        mitmproxy # interactive TLS-capable man-in-the-middle proxy
        msfconsole # Metasploit console
        ncat # network utility
        netcat # network utility
        netsniff-ng # network traffic analyzer
        nmap # network scanner
        octosuite # framework for gathering open-source intelligence on GitHub users, repositories and organisations
        # onesixtyone #
        p0f #
        patator # Multi-purpose brute-forcer
        # payloadsallthethings # lists of payloads for "CTF" challenges
        pdfcrack # PDF password cracker
        proxychains # redirect connections through proxy servers
        proxytunnel # Create tcp tunnels trough HTTPS proxies, for using with SSH
        pwntools # CTF framework and exploit development library.
        radare2 # reverse engineering framework
        rarcrack # Password cracker for rar archives
        reaper # a modern, lightweight, and deadly effective application security testing framework primed for AI
        recon-ng # reconnaissance framework
        rfkill # tool for managing radio devices
        routersploit # exploitation framework dedicated to embedded devices.
        # safecopy # data recovery and protection
        # samba # samba server
        # searxng # searx instance
        sleuthkit # tools for forensics analysis on volume and filesystem data
        # snmp # simple network management protocol
        sn0int # 0sint reconnaissance tool
        social-engineer-toolkit # social engineering framework
        socialscan # social network scanner
        # spike	# Network protocol fuzzer
        sqlitebrowser # GUI SQLite database browser
        sqlmap # Automatic SQL injection and database takeover tool
        subfinder # subdomain finder
        tcpdump # network traffic analyzer
        # tftp # trivial ftp server
        theharvester # tool for gathering e-mail accounts and subdomain names from public sources
        tshark # network traffic analyzer
        villain # High level stage 0/1 C2 framework that can handle multiple TCP socket & HoaxShell-based reverse shells
        volatility # framework for digital forensics and incident response
        wad # Web Server Application Scanner
        wireshark # network traffic analyzer
        websploit # web application security testing framework
        whatweb # web application scanner
        wfuzz # Web application bruteforcer
        whois # whois lookup tool
        wordlists # wordlists for pentesting
        # wpscan # WordPress scanner
        # zaproxy # Testing tool for finding vulnerabilities in web applications
        zenmap

        # Wireless Network Tools
        aircrack-ng # Wireless WPAWEP/WEP2 cracking tools
        cowpatty # Brute force WPA dictionary
        bully # WPS brute force attack
        hashcat # world's fastest password recovery utility
        iw # tool for configuring Linux wireless devices
        kismet # Wireless network detector
        reaver # WPS brute force attack
        macchanger # change MAC address
        pixiewps # offline WPS brute force attack
        wifite # Automate wireless networking audits with aircrack
        airgorah # WiFi security auditing software mainly based on aircrack-ng tools suite
        airgeddon # Multi-use TUI to audit wireless networks
      ];
      programs.wireshark.enable = true;
    };
  };
}
